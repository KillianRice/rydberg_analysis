function funcOut = trap_lifetime(analyVar, indivDataset, avgDataset)
    
    %% lossspectrafit - Soumya K kanungo 2020.06.12
    % Fits MCS data to a typical loss profile.
    
    form = @(coeffs, x) coeffs(1) * exp(-x/coeffs(2));% Decaying atom number
    
    indVarField = 'imagevcoAtom'; % independent variable
    depVarField = 'winTotNum'; % dependent variable
%     depVarField = 'numberAtom';
    
    %% initial guess code
    function initialguess = x0(xdata, ydata)
        
        initialguess = [100e3,1e3];
        
        initialguess(1) = max(ydata);
%         initialguess(2) = mean(ydata);
%         initialguess(3) = min(ydata);
        
        
        
    end


    %% options
    % the base_fit function is designed to be flexible, and can accept a
    % lot of different parameters to adjust 
    %%%%% Default Options %%%%%
%         options = struct(...
%         'DataPlotFunction', @defaultDataPlot,...
%         'AvgDataPlotFunction', @defaultAvgDataPlot,...
%         'FitLinePlotFunction', @defaultFitLinePlot,...
%         'AnnotateFunction', @defaultAnnotate,...
%         'IndivFitPlotFunction', @defaultIndivFitPlot,...
%         'PlotIndivFits' , true,...
%         'PlotAvgFits', true,...
%         'XAxisLabel', indVarField ,...
%         'YAxisLabel', depVarField,...
%         'FitLB', [],...
%         'FitUB', [],...
%         'FitOptions', struct('Display','off'),...
%         'PlotInitialGuess', true, ...
%         'InitialGuessPlotFunction', @defaultInitialGuessPlot,...
%         'PlotAll', true,...
%         'PlotAllAvgs', true, ...
%         'CoeffNames', {{}},...
%         'CoeffUnits', {{}},...
%         'YAxisScale', 'linear',...
%         'XAxisScale', 'linear');
    %%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    options = struct(...
        'PlotIndivFits', false,...
        'PlotAll', false,...
        'PlotAllAvgs', false,...
        'CoeffNames', {{'amp', 'lifetime', 'baseline'}},...
        'CoeffUnits', {{'','ms',''}},...
        'PlotInitialGuess', false);
    base_fit(analyVar, indivDataset, avgDataset, form, indVarField, depVarField, @x0, options)
    
    funcOut.analyVar = analyVar;
    funcOut.indivDataset = indivDataset;
    funcOut.avgDataset = avgDataset;

end

